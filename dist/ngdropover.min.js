!function(a,b){"use strict";angular.module("ngDropover",[]).run(["$document","$rootScope",function(a,c){function d(a){for(var d=[];a&&a!==b;)a.attributes&&a.attributes.getNamedItem("ng-dropover")&&d.push(a.attributes.getNamedItem("ng-dropover").nodeValue),a.attributes&&a.attributes.getNamedItem("ng-dropover-trigger")&&d.push(c.$eval(a.attributes.getNamedItem("ng-dropover-trigger").nodeValue).targetId||""),a=a.parentNode;return d}Array.prototype.indexOf||(Array.prototype.indexOf=function(a){var b=this.length>>>0,c=Number(arguments[1])||0;for(c=0>c?Math.ceil(c):Math.floor(c),0>c&&(c+=b);b>c;c++)if(c in this&&this[c]===a)return c;return-1}),c.scrolling=!1,a.on("touchmove",function(a){c.scrolling=!0}),a.on("touchend click",function(a){a=a.originalEvent&&a.originalEvent.target?a.originalEvent:a;var b=d(a.target);a.ngDropoverId&&b.push(a.ngDropoverId),3===a.which||c.scrolling||c.$emit("ngDropover.documentClick",{fromDocument:!0,ngDropoverId:b}),c.scrolling=!1})}]).constant("ngDropoverConfig",{horizontalOffset:0,verticalOffset:0,triggerEvent:"click",position:"bottom-left",closeOnClickOff:!0,staticOptions:!1,groupId:""}).constant("positions",["bottom","bottom-left","bottom-center","bottom-right","top","top-left","top-center","top-right","left","left-bottom","left-center","left-top","right","right-bottom","right-center","right-top"]).factory("triggerEventsMap",function(){var a={mouseover:"mouseleave",click:"click",focus:"blur",none:"none","touchend click":"touchend click"};return{getTriggers:function(b){return"hover"===b&&(b="mouseover"),"click"===b&&(b="touchend click"),a.hasOwnProperty(b)?{show:b,hide:a[b]}:null}}}).directive("ngDropover",["ngDropoverConfig","positions","$rootScope","$position","$document","$window","triggerEventsMap","$timeout",function(a,c,d,e,f,g,h,i){function j(a,b,c){console.log("? ngDropover Error | ID:"+a+" ?"),console.log(b),console.log(c),console.log("")}return{restrict:"A",replace:!0,scope:{target:"@ngDropover",ngDropoverOptions:"@ngDropoverOptions"},link:function(k,l,m){function n(){function e(a){a=a.originalEvent&&a.originalEvent.target?a.originalEvent:a;var c=a.target;if(a.ngDropoverId)return!0;for(;c&&c!==b&&c!==l[0];){if(c.attributes&&c.attributes.getNamedItem("ng-dropover-contents"))return!0;c=c.parentNode}return!1}k.config=angular.extend({},a,k.$eval(k.ngDropoverOptions)),k.positions=c,z={toggle:function(a){return e(a)?void 0:"touchend"===a.type&&(a.preventDefault(),d.scrolling)?void(d.scrolling=!1):void k.toggle(k.ngDropoverId)},open:function(a){e(a)||k.isOpen||k.open(k.ngDropoverId)},close:function(a){!e(a)&&k.isOpen&&k.close(k.ngDropoverId)},markEvent:function(a){a=a.originalEvent||a,a.ngDropoverId=k.ngDropoverId}},o(),p(),k.config.staticOptions?(s(),k.config=angular.extend({},a,k.$eval(k.ngDropoverOptions)),"string"==typeof k.config.position&&-1!==k.positions.indexOf(k.config.position)||(j(k.ngDropoverId,angular.element(l),"Position must be a string and one of these values: "+k.positions),k.config.position="bottom-left"),q(),t(),u()):k.$watch("ngDropoverOptions",function(){s(),k.config=angular.extend({},a,k.$eval(k.ngDropoverOptions)),"string"==typeof k.config.position&&-1!==k.positions.indexOf(k.config.position)||(j(k.ngDropoverId,angular.element(l),"Position must be a string and one of these values: "+k.positions),k.config.position="bottom-left"),q(),t(),u()},!0),f.ready(function(){t()})}function o(){l.addClass(k.config.groupId+" ngdo"),l.attr("ng-dropover",k.ngDropoverId),y=v(),y.css({position:"absolute",display:"none"}).addClass("ngdo-contents "+k.config.groupId),A.event=w(),A.handler=function(a){"visibility"!==a.propertyName&&(y.css({display:"none"}),y[0].removeEventListener(A.event,A.handler))},y.on("touchend click",z.markEvent)}function p(){k.dropoverObj={options:k.config,id:k.ngDropoverId,children:l[0].querySelectorAll("[ng-dropover]"),element:l,dropoverContents:y}}function q(){var a=h.getTriggers(k.config.triggerEvent);a||j(k.ngDropoverId,angular.element(l),"triggerEvent must be a string: 'none', 'click', 'hover', 'focus'"),a&&"none"!==a.show&&(a.show===a.hide?l.on(a.show,z.toggle):(r(l[0])&&l.on("touchend",z.toggle),l.on(a.show,z.open),l.on(a.hide,z.close),"hover"===k.config.triggerEvent&&y.on("mouseleave",function(){z.close({})})))}function r(a){return!(!a.attributes||!a.attributes.getNamedItem("ng-click")&&!a.attributes.getNamedItem("href"))}function s(){var a=h.getTriggers(k.config.triggerEvent);a&&"none"!==a.show&&(a.show===a.hide?l.off(a.show,z.toggle):(r(l[0])&&l.off("touchend",z.toggle),l.off(a.show,z.open),l.off(a.hide,z.close),"hover"===k.config.triggerEvent&&y.off("mouseleave",function(){z.close({})})))}function t(){var a,b,c,d;a=parseInt(k.config.horizontalOffset,10)||0,b=parseInt(k.config.verticalOffset,10)||0,d=y.css("display"),y.css({visibility:"hidden",display:""}),c=e.positionElements(l,y,k.config.position,!1),y.css({left:c.left+a+"px",top:c.top+b+"px",display:d,visibility:""})}function u(){for(var a=l[0].className.split(" "),b=0,c=a.length;c>b;b++){var d=a[b].substring(5,a[b].length);k.positions.indexOf(d)>0&&l.removeClass(a[b])}l.addClass("ngdo-"+k.config.position)}function v(){var a;return l[0].querySelector("[ng-dropover-contents]")?a=angular.element(l[0].querySelector("[ng-dropover-contents]")):(a=angular.element("<div class='ngdo-empty'>Oops, you forgot to specify what goes in the dropdown</div>"),l.append(a),a)}function w(){var a,b={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",webkitTransition:"webkitTransitionEnd"},c={transition:"transitionDuration",OTransition:"oTransitionDuration",MozTransition:"MozTransitionDuration",webkitTransition:"WebkitTransitionDuration"};for(a in b)if(void 0!==y[0].style[a]&&parseFloat(e.getStyle(y[0],c[a]),10)>0)return A.duration=Math.floor(1e3*parseFloat(e.getStyle(y[0],c[a]),10)),b[a]}function x(){var a=d.$broadcast("ngDropover.closing",k.dropoverObj);a.defaultPrevented||(A.event?i(function(){k.isOpen||y[0].addEventListener(A.event,A.handler)},A.duration/2):y.css({display:"none"}),l.removeClass("ngdo-open"),k.isOpen=!1,angular.element(g).unbind("resize",t))}var y,z,A={duration:0};n(),k.open=function(a){if(A.event&&y[0].removeEventListener(A.event,A.handler),a===k.ngDropoverId&&!k.isOpen){var b=d.$broadcast("ngDropover.opening",k.dropoverObj);b.defaultPrevented||(t(),y.css({display:"inline-block"}),l.addClass("ngdo-open"),angular.element(g).bind("resize",t),k.isOpen=!0)}},k.close=function(a){a===k.ngDropoverId&&k.isOpen&&x()},k.toggle=function(a){k.isOpen?k.close(a):k.open(a)},k.closeAll=function(a){k.isOpen&&a!==k.ngDropoverId&&x()},k.$on("$destroy",function(){s(),angular.element(g).unbind("resize",t),y.off("touchend click",z.markEvent)})},controller:["$scope","$element","$attrs",function(a,b,c){a.isOpen=!1,a.ngDropoverId=a.target||""+a.$id,a.openListener=d.$on("ngDropover.open",function(b,c){a.open(c)}),a.closeListener=d.$on("ngDropover.close",function(b,c){a.close(c)}),a.toggleListener=d.$on("ngDropover.toggle",function(b,c){a.isOpen?a.close(c):a.open(c)}),a.closeAllListener=d.$on("ngDropover.closeAll",function(b,c){a.closeAll(c)}),a.documentClickListener=d.$on("ngDropover.documentClick",function(b,c){c.ngDropoverId&&!(c.ngDropoverId.indexOf(a.ngDropoverId)<0)||!a.config.closeOnClickOff&&c.fromDocument||a.closeAll()}),a.$on("$destroy",function(){a.openListener(),a.openListener=null,a.closeListener(),a.closeListener=null,a.toggleListener(),a.toggleListener=null,a.closeAllListener(),a.closeAllListener=null,a.documentClickListener(),a.documentClickListener=null})}]}}]).factory("$position",["$document","$window",function(a,b){function c(a,c){return a.currentStyle?a.currentStyle[c]:b.getComputedStyle?b.getComputedStyle(a,null)[c]:a.style[c]}function d(a){return"static"===(c(a,"position")||"static")}var e=function(b){for(var c=a[0],e=b.offsetParent||c;e&&e!==c&&d(e);)e=e.offsetParent;return e||c};return{getStyle:c,position:function(b){var c=this.offset(b),d={top:0,left:0},f=e(b[0]);f!==a[0]&&(d=this.offset(angular.element(f)),d.top+=f.clientTop-f.scrollTop,d.left+=f.clientLeft-f.scrollLeft);var g=b[0].getBoundingClientRect();return{width:g.width||b.prop("offsetWidth"),height:g.height||b.prop("offsetHeight"),top:c.top-d.top,left:c.left-d.left}},offset:function(c){var d=c[0].getBoundingClientRect();return{width:d.width||c.prop("offsetWidth"),height:d.height||c.prop("offsetHeight"),top:d.top+(b.pageYOffset||a[0].documentElement.scrollTop),left:d.left+(b.pageXOffset||a[0].documentElement.scrollLeft)}},positionElements:function(a,b,c,e){var f,g,h,i,j=c.split("-"),k=j[0],l=j[1]||"center";f=e?this.offset(a):this.position(a),d(a[0])||(f.top=-a[0].clientTop,f.left=-a[0].clientLeft),g=b.prop("offsetWidth"),h=b.prop("offsetHeight");var m={center:function(){return f.left+f.width/2-g/2},left:function(){return f.left},right:function(){return"right"===l?f.left+(f.width-g):f.left+f.width}},n={center:function(){return f.top+f.height/2-h/2},top:function(){return f.top},bottom:function(){return f.top+f.height}};switch(k){case"right":i={top:n[l](),left:m[k]()};break;case"left":i={top:n[l](),left:f.left-g};break;case"bottom":i={top:n[k](),left:m[l]()};break;default:i={top:f.top-h,left:m[l]()}}return i}}}]).directive("ngDropoverTrigger",["$rootScope","$document","triggerEventsMap",function(a,b,c){return{restrict:"AE",scope:{triggerOptions:"@ngDropoverTrigger"},link:function(b,d,e){var f=b.$eval(b.triggerOptions),g=c.getTriggers(f.triggerEvent||"click");d.addClass("ngdo-trigger");var h={action:function(a){b.$emit("ngDropover."+f.action,f.targetId)},toggle:function(c){return"touchend"===c.type&&(c.preventDefault(),a.scrolling)?void(a.scrolling=!1):void b.$emit("ngDropover.toggle",f.targetId)},show:function(a){b.$emit("ngDropover.open",f.targetId)},hide:function(a){b.$emit("ngDropover.close",f.targetId)},touch:function(c){return c.preventDefault(),a.scrolling?void(a.scrolling=!1):void b.$emit("ngDropover."+(f.action||"toggle"),f.targetId)}};"open"===f.action||"close"===f.action?d.on(g.show,h.action):g.show===g.hide?d.on(g.show,h.toggle):(d.on(g.show,h.show),d.on(g.hide,h.hide)),"hover"===f.triggerEvent&&d.on("touchend",h.touch),b.$on("destroy",function(){"open"===f.action||"close"===f.action?d.off(g.show,h.action):g.show===g.hide?d.off(g.show,h.toggle):(d.off(g.show,h.show),d.off(g.hide,h.hide)),"hover"===f.triggerEvent&&d.off("touchend",h.touch)})}}}])}(window,document);